import{a as B,o as n,c as M,C as D,b as v,f as l,t as p,F as R,s as V,i as N,h as E,T as O,v as C,q as G,D as H,p as J,j as W,w as P,k as X,l as Z,x as L,m as Q,r as T,A as ee,u as a,_ as te}from"./entry.f9d8c4ae.js";import{u as se}from"./asyncData.423dc0a4.js";const ae={key:0,class:"test-card"},ne={class:"test-card__info"},re={class:"test-card__kanji"},oe=["onClick"],ue={__name:"card",props:{kanjiArray:{type:Array,required:!0},questions:{type:Array,required:!0},currentQuestion:{type:Number,required:!0},show:{type:Boolean,default:!0}},emits:["selectAnswer"],setup(e,{emit:h}){const k=o=>{h("selectAnswer",o)};return(o,i)=>(n(),M(O,{name:"bottom-fade"},{default:D(()=>[e.show?(n(),v("div",ae,[l("div",ne," Question "+p(e.currentQuestion+1)+" / "+p(e.kanjiArray.length),1),l("div",re,p(e.questions[e.currentQuestion].kanji),1),l("div",{class:N(["test-card-variants",{"__not-answered":e.questions[e.currentQuestion].status==="notAnswered"}])},[(n(!0),v(R,null,V(e.questions[e.currentQuestion].variants,(r,d)=>(n(),v("div",{key:"test-card-variants-item-"+d,class:N(["test-card-variants__item",{__correct:e.questions[e.currentQuestion].userAnswerIndex===d&&e.questions[e.currentQuestion].status==="correct"},{__wrong:e.questions[e.currentQuestion].userAnswerIndex===d&&e.questions[e.currentQuestion].status==="wrong"}]),onClick:_=>k(d)},p(r),11,oe))),128))],2)])):E("",!0)]),_:1}))}},ce=B(ue,[["__scopeId","data-v-66c71138"]]),le={__name:"button",props:{text:{type:String,default:"text"},show:{type:Boolean,default:!0}},emits:["onClick"],setup(e,{emit:h}){const k=e,o=()=>{!k.show||h("onClick")};return(i,r)=>(n(),M(O,{name:"bottom-fade"},{default:D(()=>[e.show?(n(),v("button",{key:0,class:"ui-button",onClick:o},p(e.text),1)):E("",!0)]),_:1}))}},ie=B(le,[["__scopeId","data-v-60f1900e"]]),z=e=>(J("data-v-b473848c"),e=e(),W(),e),de={key:0,class:"results"},_e=z(()=>l("div",{class:"results__title"},"Results",-1)),ve={class:"results-table"},he=z(()=>l("div",{class:"results-row"},[l("div",{class:"results-kanji"}," Kanji "),l("div",{class:"results-user-answer"}," Your answer "),l("div",{class:"results-answers"}," Correct answers ")],-1)),fe={class:"results-kanji"},me={class:"results-user-answer"},we={class:"results-answers"},ke={__name:"results",props:{questions:{type:Array,default:[]},show:{type:Boolean,default:!0}},setup(e){return(h,k)=>{const o=H;return n(),M(O,{name:"results"},{default:D(()=>[e.show?(n(),v("div",de,[_e,l("div",ve,[he,(n(!0),v(R,null,V(e.questions,(i,r)=>(n(),v("div",{class:N(["results-row",{__correct:i.status==="correct"}]),key:"results-row-"+r},[l("div",fe,[C(o,{href:`/kanji/${i.kanji}/`,target:"_blank",class:N(["results-kanji__link"])},{default:D(()=>[G(p(i.kanji),1)]),_:2},1032,["href"])]),l("div",me,p(i.variants[i.userAnswerIndex]),1),l("div",we,[(n(!0),v(R,null,V(i.meanings,(d,_)=>(n(),v("span",{key:"results-answers-"+_},p(d),1))),128))])],2))),128))])])):E("",!0)]),_:1})}}},ge=B(ke,[["__scopeId","data-v-b473848c"]]);const pe={class:"page container"},ye={class:"content"},Ae={key:0,class:"loading"},je={key:1,class:"test"},xe={__name:"[slug]",async setup(e){let h,k;const{words:o}=([h,k]=P(()=>te(()=>import("./words.c5e84632.js"),[],import.meta.url)),h=await h,k(),h),i=X(),r=Z(),{$filters:d}=L(),_=Q(()=>i.params.slug.split("-")[0]||"kanjigrades"),F=Q(()=>i.params.slug.split("-")[1]||"ap"),K=Q(()=>i.params.slug.split("-")[2]||"0"),g=Q(()=>_.value==="kanjigrades"?F.value:`${F.value}:c${K.value}`||"ap:c1");[h,k]=P(()=>se("kanjilists",()=>{var t,s,w,f;_.value==="kanjigrades"&&((s=(t=r.data)==null?void 0:t[_.value])!=null&&s[g.value]||r.fetchDynamicData(_.value,g.value,{grade:g.value})),_.value==="kanjilists"&&((f=(w=r.data)==null?void 0:w[_.value])!=null&&f[g.value]||r.fetchDynamicData(_.value,g.value,{list:g.value}))})),await h,k();const y=Q(()=>{var t,s,w,f;return(s=(t=r.data)==null?void 0:t[_.value])!=null&&s[g.value]?(console.log("shuffle"),d.shuffle((f=(w=r.data)==null?void 0:w[_.value])==null?void 0:f[g.value])):[]}),u=T([]),c=T(0),I=T(!1),q=(t,s)=>{var w,f,b,S;if(!u.value[t])if(!((f=(w=r.data)==null?void 0:w.kanji)!=null&&f[s[t].kanji.character]))r.fetchDynamicAdditionData("kanji",s[t].kanji.character).then(j=>{const x=d.shuffle(j.kanji.meaning.english.split(", "));let m=[x[0]];for(let A=0;A<7;A++){const $=Math.floor(Math.random()*o.length);if(m.includes(o[$])){A--;continue}m.push(o[$])}m=d.shuffle(m),u.value[t]={kanji:j.kanji.character,meanings:x,variants:m,status:"notAnswered",userAnswerIndex:-1}});else{const j=(S=(b=r.data)==null?void 0:b.kanji)==null?void 0:S[s[t].kanji.character],x=d.shuffle(j.kanji.meaning.english.split(", "));let m=[x[0]];for(let A=0;A<7;A++){const $=Math.floor(Math.random()*o.length);if(m.includes(o[$])){A--;continue}m.push(o[$])}m=d.shuffle(m),u.value[t]={kanji:j.kanji.character,meanings:x,variants:m,status:"notAnswered",userAnswerIndex:-1}}},U=()=>{c.value+=1};y.value.length&&(q(0,y.value),q(1,y.value)),ee([c,()=>y.value],([t,s])=>{console.log("asd",t,s[t].kanji.character),q(t,s),t+1<s.length&&q(t+1,s)});const Y=t=>{u.value[c.value].userAnswerIndex=t,u.value[c.value].meanings.includes(u.value[c.value].variants[t])?u.value[c.value].status="correct":u.value[c.value].status="wrong"};return(t,s)=>{const w=ce,f=ie,b=ge;return n(),v("div",pe,[l("div",ye,[a(u)[a(c)]?(n(),v("div",je,[C(w,{kanjiArray:a(y),questions:a(u),currentQuestion:a(c),show:!a(I),onSelectAnswer:Y},null,8,["kanjiArray","questions","currentQuestion","show"]),C(f,{show:a(u)[a(c)].status!=="notAnswered"&&a(c)+1<a(y).length,text:"Next",onOnClick:U},null,8,["show"]),C(f,{show:!a(I)&&a(u)[a(c)].status!=="notAnswered"&&a(c)+1===a(y).length,text:"Show results",onOnClick:s[0]||(s[0]=S=>I.value=!0)},null,8,["show"]),C(b,{show:a(I),questions:a(u)},null,8,["show","questions"])])):(n(),v("div",Ae))])])}}},Ce=B(xe,[["__scopeId","data-v-063d3122"]]);export{Ce as default};
